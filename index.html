<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover" />
<title>ECHO JR Â· UPDATE GOD</title>
<style>
:root { --pink1:#ff2e88; --pink2:#ff6b9d; --white:#ffffff; }

html,body{
  margin:0;height:100%;width:100%;background:transparent;color:var(--pink2);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  display:flex;align-items:center;justify-content:center;text-align:center;overflow:hidden;
}

iframe.bg,iframe.front{position:fixed;top:0;left:0;width:100%;height:100%;border:none;background:transparent;pointer-events:none;}
iframe.bg{z-index:-2;} iframe.front{z-index:0;opacity:.65;}

.container{position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;}
footer{font-size:18px;font-weight:900;letter-spacing:2px;text-transform:uppercase;color:var(--pink2);margin-bottom:25px;}

.jr-btn{
  width:200px;margin:8px;padding:12px 0;border-radius:30px;font-size:18px;font-weight:600;text-align:center;
  background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.25);color:var(--pink2);cursor:pointer;
  box-shadow:0 4px 20px rgba(255,47,137,0.5);backdrop-filter:blur(12px) saturate(160%);
  transition:box-shadow .25s ease,transform .1s ease;
}
.jr-btn:hover{box-shadow:0 6px 24px rgba(255,47,137,0.8);transform:scale(1.03);}

#githubSearch{
  position:fixed;bottom:40px;left:50%;transform:translateX(-50%);
  width:240px;padding:12px 24px;border-radius:30px;font-size:18px;font-weight:600;text-align:center;
  background:transparent;border:2px solid rgba(255,255,255,0.25);color:var(--pink2);
  box-shadow:0 0 20px rgba(255,47,137,0.4);z-index:200;transition:all .3s ease;
}
#githubSearch::placeholder{color:var(--pink2);}
#githubSearch:focus{outline:none;box-shadow:0 0 26px rgba(255,47,137,0.8);border-color:rgba(255,47,137,0.9);}

#actionBox{
  position:fixed;top:50%;left:50%;width:360px;height:420px;
  transform:translate(-50%,-50%) scale(.9);
  background:rgba(255,255,255,0.08);backdrop-filter:blur(12px);
  border:3px solid var(--pink2);border-radius:20px;color:var(--white);
  display:none;flex-direction:column;z-index:500;box-shadow:0 0 20px rgba(255,47,137,0.4);
  transition:opacity .3s ease,transform .3s ease;opacity:0;overflow:hidden;
}
#actionBox.active{display:flex;opacity:1;transform:translate(-50%,-50%) scale(1);}
#actionHeader{padding:12px 16px;border-bottom:2px solid rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:space-between;}
#actionTitle{font-size:18px;color:var(--pink2);margin:0;}
#closeAction{font-weight:700;color:var(--white);background:var(--pink2);border:none;border-radius:16px;padding:6px 12px;cursor:pointer;}

#repoList{flex:1;padding:12px 16px;overflow:auto;text-align:left;color:var(--white);}
.repo{padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.12);}
.repo a{color:var(--pink2);text-decoration:none;font-weight:700;word-break:break-word;cursor:pointer;}
.meta{font-size:12px;opacity:.85;margin-top:4px;}

#chatModal{
  position:fixed;bottom:80px;right:20px;width:320px;height:260px;background:black;border:2px solid #0f0;border-radius:16px;
  box-shadow:0 0 30px #0f0;z-index:600;display:none;flex-direction:column;overflow:hidden;
}
#chatModal iframe{width:100%;height:100%;}
#chatClose{position:absolute;top:6px;right:12px;color:#0f0;font-size:20px;cursor:pointer;z-index:10;}
#chatBtn{margin-top:20px;width:60px;height:60px;border-radius:50%;
  background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.25);
  color:var(--pink2);font-size:22px;box-shadow:0 0 20px rgba(255,47,137,0.5);
  backdrop-filter:blur(12px);cursor:pointer;transition:transform .2s ease;}
#chatBtn:hover{transform:scale(1.1);}

pre.codeList{white-space:pre-wrap;word-break:break-word;font-family:monospace;font-size:12px;line-height:1.4;color:var(--white);}
.codePart{border-bottom:1px solid rgba(255,255,255,0.1);padding:4px 0;cursor:pointer;}
.codePart:hover{background:rgba(255,255,255,0.08);}
</style>
</head>
<body>

<iframe src="luhve.html" class="bg"></iframe>
<iframe src="luhvefront.html" class="front"></iframe>
<iframe src="spin.html?v=2" style="position:absolute;top:calc(50% - 70px);left:50%;
  transform:translateX(-50%);width:100%;height:60px;border:none;background:transparent;pointer-events:none;z-index:1;"></iframe>

<div class="container">
  <footer>ECHO JR Â· UPDATE GOD</footer>
  <button class="jr-btn" id="addBtn">Add</button>
  <button class="jr-btn" id="removeBtn">Remove</button>
  <button class="jr-btn" id="replaceBtn">Replace</button>
  <button id="chatBtn">help</button>
</div>

<input type="text" id="githubSearch" placeholder="GitHub Username" autocomplete="off" />

<div id="chatModal">
  <div id="chatClose">Ã—</div>
  <iframe src="talk2echojr.html" frameborder="0"></iframe>
</div>

<div id="actionBox">
  <div id="actionHeader">
    <h2 id="actionTitle">Action Mode</h2>
    <button id="closeAction">Close</button>
  </div>
  <div id="repoList"></div>
</div>

<script>
const input=document.getElementById("githubSearch");
const actionBox=document.getElementById("actionBox");
const actionTitle=document.getElementById("actionTitle");
const repoList=document.getElementById("repoList");
const closeAction=document.getElementById("closeAction");
let lastSelectedFile=null;

function openBox(title,content=""){actionTitle.textContent=title;if(content)repoList.innerHTML=content;
  actionBox.style.display="flex";requestAnimationFrame(()=>actionBox.classList.add("active"));}
function closeBox(){actionBox.classList.remove("active");setTimeout(()=>actionBox.style.display="none",300);}
if(closeAction)closeAction.addEventListener("click",closeBox);

// add/remove/replace base
document.getElementById("addBtn").addEventListener("click",()=>openBox("Add Mode",
  '<textarea style="width:100%;height:80%;background:rgba(0,0,0,0.3);color:var(--pink2);border:none;outline:none;font-family:monospace;font-size:14px;border-radius:10px;padding:10px;resize:none;" placeholder="Type code or text to add..."></textarea>'));
document.getElementById("replaceBtn").addEventListener("click",()=>openBox("Replace Mode",
  '<textarea style="width:100%;height:80%;background:rgba(0,0,0,0.3);color:var(--pink2);border:none;outline:none;font-family:monospace;font-size:14px;border-radius:10px;padding:10px;resize:none;" placeholder="Paste new replacement code..."></textarea>'));

document.getElementById("removeBtn").addEventListener("click",async()=>{
  openBox("Remove Mode");
  if(!lastSelectedFile){repoList.innerHTML="<div class='meta'>Select a file first.</div>";return;}
  repoList.innerHTML=`<div class='meta'>Loading ${lastSelectedFile.name}â€¦</div>`;
  try{
    const text=await fetch(lastSelectedFile.downloadUrl).then(r=>r.text());
    // Split into parts (simple tag/block separation)
    const parts=text.split(/(?=<\/?[a-zA-Z])/).filter(x=>x.trim());
    repoList.innerHTML=`<pre class='codeList'>`+
      parts.map(p=>`<div class='codePart'>${escapeHtml(p)}</div>`).join("")+
      `</pre>`;
  }catch(err){
    repoList.innerHTML=`<div class='meta'>Failed to load. ${err}</div>`;
  }
});

function escapeHtml(s){return s.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}

// GitHub search
input.addEventListener("keydown",async e=>{
  if(e.key!=="Enter")return;e.preventDefault();
  const user=input.value.trim();if(!user)return;
  openBox("Repos Â· "+user,"<div class='meta'>Loadingâ€¦</div>");
  const res=await fetch(`https://api.github.com/users/${encodeURIComponent(user)}/repos?per_page=100&sort=updated`);
  const data=await res.json();
  repoList.innerHTML=data.map(r=>`<div class='repo' data-user='${user}' data-repo='${r.name}'><a href='#' class='repo-link'>${r.name}</a></div>`).join("");
  document.querySelectorAll(".repo-link").forEach(l=>l.addEventListener("click",ev=>{
    ev.preventDefault();showFiles(user,ev.target.textContent);
  }));
});

async function showFiles(user,repo){
  openBox("Files Â· "+repo,"<div class='meta'>Loadingâ€¦</div>");
  const res=await fetch(`https://api.github.com/repos/${encodeURIComponent(user)}/${encodeURIComponent(repo)}/contents`);
  const data=await res.json();
  repoList.innerHTML=data.map(f=>
    `<div class='repo'><a href='#' class='file-link' data-download='${f.download_url}' data-name='${f.name}'>ðŸ“„ ${f.name}</a></div>`).join("");
  document.querySelectorAll(".file-link").forEach(l=>l.addEventListener("click",ev=>{
    ev.preventDefault();
    lastSelectedFile={downloadUrl:l.getAttribute("data-download"),name:l.getAttribute("data-name")};
    input.value=l.getAttribute("data-name");closeBox();
  }));
}

// ESC closes
window.addEventListener("keydown",e=>{if(e.key==="Escape"&&actionBox.classList.contains("active"))closeBox();});

// chat modal
const chatBtn=document.getElementById("chatBtn");
const chatModal=document.getElementById("chatModal");
const chatClose=document.getElementById("chatClose");
chatBtn.addEventListener("click",()=>chatModal.style.display="flex");
chatClose.addEventListener("click",()=>chatModal.style.display="none");
</script>
</body>
</html>
