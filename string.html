<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Heart Balloon Â· Remote Drag</title>
<style>
html,body{
  margin:0;
  height:100%;
  width:100%;
  background:#fff;
  overflow:hidden;
  touch-action:none;
}
canvas{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
}

/* balloon */
svg{
  position:absolute;
  width:160px;
  height:420px;
  filter:drop-shadow(0 0 18px rgba(255,80,150,0.6));
  user-select:none;
  pointer-events:none;
}

/* demo buttons */
button{
  position:absolute;
  padding:10px 20px;
  border:none;
  border-radius:8px;
  background:#ff4fa5;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
  font-family:sans-serif;
}
#btn1{top:40%;left:40%;}
#btn2{top:70%;left:60%;}
</style>
</head>
<body>

<canvas id="rope"></canvas>
<button id="btn1">Add</button>
<button id="btn2">Replace</button>

<svg id="balloon" viewBox="0 0 100 400">
  <defs>
    <radialGradient id="grad" cx="35%" cy="25%" r="65%">
      <stop offset="0%" stop-color="#ffb7df"/>
      <stop offset="40%" stop-color="#ff4fa5"/>
      <stop offset="100%" stop-color="#ff007b"/>
    </radialGradient>
  </defs>
  <path fill="url(#grad)" d="
    M50 20
    C35 0, 5 10, 5 40
    C5 70, 40 100, 50 130
    C60 100, 95 70, 95 40
    C95 10, 65 0, 50 20
    Q50 132, 50 134
  "/>
</svg>

<script>
const balloon=document.getElementById("balloon");
const canvas=document.getElementById("rope");
const ctx=canvas.getContext("2d");
const buttons=[...document.querySelectorAll("button")];
let W,H;
function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight;}
resize(); addEventListener("resize",resize);

// random spawn
let bx=Math.random()*innerWidth*0.7+100;
let by=Math.random()*innerHeight*0.4+100;
balloon.style.left=bx-80+"px";
balloon.style.top=by+"px";

// rope setup
const N=12, seg=26;
const nodes=Array.from({length:N},(_,i)=>({x:bx,y:by+i*seg,vx:0,vy:0}));

// invisible remote drag vars
let remoteActive=false;
let remoteX=bx, remoteY=by;

function setRemote(p){
  // ignore if click on a button
  const t=p.target;
  if(t.tagName==="BUTTON") return;
  remoteActive=true;
  remoteX=p.clientX;
  remoteY=p.clientY;
}
function moveRemote(p){
  if(!remoteActive) return;
  remoteX=p.clientX;
  remoteY=p.clientY;
}
function clearRemote(){
  remoteActive=false;
}

document.addEventListener("mousedown",setRemote);
document.addEventListener("mousemove",moveRemote);
document.addEventListener("mouseup",clearRemote);
document.addEventListener("touchstart",e=>setRemote(e.touches[0]));
document.addEventListener("touchmove",e=>moveRemote(e.touches[0]));
document.addEventListener("touchend",clearRemote);

let vx=0, vy=0;

function loop(){
  requestAnimationFrame(loop);
  ctx.clearRect(0,0,W,H);

  // free float
  by += Math.sin(Date.now()/800)*0.25;
  bx += Math.cos(Date.now()/1000)*0.1;

  // when remote active, balloon eases toward pointer
  if(remoteActive){
    vx += (remoteX - bx) * 0.02;
    vy += (remoteY - by) * 0.02;
  }

  // friction
  vx *= 0.94;
  vy *= 0.94;
  bx += vx;
  by += vy;

  // keep inside screen
  bx=Math.max(80,Math.min(innerWidth-80,bx));
  by=Math.max(60,Math.min(innerHeight-160,by));

  // update balloon position
  balloon.style.left=bx-80+"px";
  balloon.style.top=by+"px";

  // rope physics
  nodes[0].x=bx;
  nodes[0].y=by+140;

  for(let i=1;i<N;i++){
    let n=nodes[i],prev=nodes[i-1];

    // light gravity
    n.vy+=0.04;
    n.x+=n.vx;
    n.y+=n.vy;

    // air resistance
    n.vx*=0.94;
    n.vy*=0.94;

    // tension constraint
    let dx=n.x-prev.x, dy=n.y-prev.y;
    let dist=Math.hypot(dx,dy);
    let diff=(dist-seg)/dist;
    diff=Math.min(Math.max(diff,-0.25),0.25);
    n.x-=dx*diff*0.5;
    n.y-=dy*diff*0.5;
    prev.x+=dx*diff*0.5;
    prev.y+=dy*diff*0.5;

    // button collision
    for(const b of buttons){
      const br=b.getBoundingClientRect();
      if(n.x>br.left && n.x<br.right && n.y>br.top && n.y<br.bottom){
        n.y=br.top-1;
        n.vy*=-0.3;
      }
    }
  }

  // draw rope
  ctx.beginPath();
  ctx.moveTo(nodes[0].x,nodes[0].y);
  for(let i=1;i<N;i++) ctx.lineTo(nodes[i].x,nodes[i].y);
  ctx.strokeStyle="rgba(255,47,137,0.85)";
  ctx.lineWidth=2;
  ctx.lineCap="round";
  ctx.shadowColor="rgba(255,47,137,0.4)";
  ctx.shadowBlur=8;
  ctx.stroke();
  ctx.shadowBlur=0;
}
loop();
</script>
</body>
</html>
